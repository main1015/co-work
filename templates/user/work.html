{% extends "/common/layout.html" %}
{% block title %}我的旅途{% endblock %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="{{s_domain}}/css/lib/bootstrap-datepicker/datepicker.css">
    <link rel="stylesheet" href="{{s_domain}}/css/lib/bootstrap-switch/bootstrap-switch.css">
    <link rel="stylesheet" href="{{s_domain}}/css/common/subtitle_top.css">
    <link rel="stylesheet" href="{{s_domain}}/css/user/base.css">
    <link rel="stylesheet" href="{{s_domain}}/css/user/work.css">
    <script src="{{ s_domain }}/js/bootstrap-alert.js"></script>
    <script src="{{ s_domain }}/js/bootstrap-modal.js"></script>

    <script src="{{ s_domain }}/js/lib/bootstrap-datepicker/bootstrap-datepicker.js"></script>
    <script src="{{ s_domain }}/js/lib/bootstrap-datepicker/locales/bootstrap-datepicker.zh-CN.js"
            charset="UTF-8"></script>


{% endblock %}

{% block content %}
    {% include "/common/top.html" with context %}
    {% include "/common/subtitle_top.html" with context %}
    <div class="container">
        <!-- Button to trigger modal -->
        <a href="#add_modal" role="button" class="btn" data-toggle="modal">添加工作经历</a>
        {% from "/user/module/introduce.html" import introduce %}
        {%- for w in works %}
            {{ introduce(w) }}
        {% endfor -%}
    </div>

    <!-- Modal -->
    <div id="add_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="addModalLabel" aria-hidden="true">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="addModalLabel">我的工作经历</h3>
        </div>
        <form class="form-horizontal" method="post" id="iform" action="/u/work_experience.post">
            <div class="modal-body">
                {{ form.csrf_token }}
                <div class="control-group">
                    {{ form.company_name.label(class="control-label tip") }}
                    <div class="controls">
                        {{ form.company_name(id="company_name", placeholder="公司名称") }}
                        {% if form.company_name.errors %}
                            <div class="alert alert-error">
                                <button type="button" class="close" data-dismiss="alert">×</button>
                                <ul>{% for error in form.company_name.errors %}
                                    <li>{{ error }}</li>{% endfor %}</ul>
                            </div>
                        {% endif %}
                    </div>
                </div>
                <div class="control-group">
                    {{ form.position.label(class="control-label tip") }}
                    <div class="controls">
                        {{ form.position(id="position", placeholder="职位") }}
                        {% if form.position.errors %}
                            <div class="alert alert-error">
                                <button type="button" class="close" data-dismiss="alert">×</button>
                                <ul>{% for error in form.position.errors %}
                                    <li>{{ error }}</li>{% endfor %}</ul>
                            </div>
                        {% endif %}
                    </div>
                </div>

                <div class="control-group">
                    {{ form.entry_at.label(class="control-label tip") }}
                    <div class="controls">
                        <div class="input-append date">
                            {{ form.entry_at(id="entry_at", placeholder="入职日期",class="form-control") }}
                            <span id="date-entry" class="add-on"><i class="icon-th"></i></span>
                        </div>
                        {% if form.entry_at.errors %}
                            <div class="alert alert-error">
                                <button type="button" class="close" data-dismiss="alert">×</button>
                                <ul>{% for error in form.entry_at.errors %}
                                    <li>{{ error }}</li>{% endfor %}</ul>
                            </div>
                        {% endif %}
                    </div>
                </div>
                <div class="control-group">
                    <div class="controls">
                        <div class="switch" id="resign-switch" data-on-label="已离职" data-off-label="未离职" tabindex=1>
                            <input type="checkbox" {{ 'checked' if form.is_resign.data}}/>
                        </div>
                        {{ form.is_resign(class="hide") }}
                    </div>
                </div>
                <div class="control-group {{'hide' if not form.is_resign.data }} action-dimission">
                    {{ form.dimission_at.label(class="control-label tip") }}
                    <div class="controls">
                        <div class="input-append date">
                            {{ form.dimission_at(id="dimission_at", placeholder="离职日期") }}
                            <span id="date-dimission" class="add-on"><i class="icon-th"></i></span>
                        </div>
                        {% if form.dimission_at.errors %}
                            <div class="alert alert-error">
                                <button type="button" class="close" data-dismiss="alert">×</button>
                                <ul>{% for error in form.dimission_at.errors %}
                                    <li>{{ error }}</li>{% endfor %}</ul>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">关闭</button>
                <button class="btn btn-primary">保存</button>
            </div>
        </form>
    </div>

    <script type='text/javascript'>
        $('#add_modal').modal({
            show: {{ 'true' if is_error else 'false' }}
        });
    </script>
{% endblock %}
{%- block  last_script%}
    {{ super() }}
    <script src="{{ s_domain }}/js/lib/bootstrap-switch/bootstrap-switch.js"></script>
    <script src="{{ s_domain }}/js/user/work.js"></script>
{% endblock -%}